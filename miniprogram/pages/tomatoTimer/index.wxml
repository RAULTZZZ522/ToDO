<wxs module="timeUtil">
function formatTime(t) {
  var m = Math.floor(t / 60);
  var s = t % 60;
  return m + ":" + (s < 10 ? "0" + s : s);
}

module.exports = {
  formatTime: formatTime
};
</wxs>

<view class="timer-page">
  <view class="header">ä»»åŠ¡æ—¶é’Ÿ</view>
  
  <!-- ä»»åŠ¡é€‰æ‹© -->
  <view class="task-selector">
    <view class="selector-content">
      <view class="task-name">{{title}}</view>
      <view class="task-category" wx:if="{{category}}">{{category}}</view>
      <view class="arrow">â–¼</view>
    </view>
  </view>
  
  <!-- è‡ªå®šä¹‰æ—¶é•¿é€‰æ‹©å™¨ -->
  <view class="duration-selector" bindtap="toggleDurationPicker">
    <view class="duration-display">
      <text>æ—¶é•¿: {{duration}} åˆ†é’Ÿ</text>
      <text class="arrow">â–¼</text>
    </view>
    
    <!-- æ—¶é•¿é€‰æ‹©é¢æ¿ -->
    <view class="duration-options {{showDurationPicker ? 'show' : ''}}">
      <view 
        wx:for="{{durationOptions}}" 
        wx:key="value"
        class="duration-option {{duration === item.value ? 'active' : ''}}" 
        bindtap="selectDuration"
        data-duration="{{item.value}}">
        {{item.label}}
      </view>
      <!-- è‡ªå®šä¹‰è¾“å…¥æ—¶é•¿é€‰é¡¹å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ  -->
    </view>
  </view>
  
  <!-- ä¸»è®¡æ—¶åŒºåŸŸ -->
  <view class="timer-container">
    <!-- è¿›åº¦åœ†ç¯ -->
    <view class="progress-ring">
      <canvas canvas-id="progressCanvas" class="progress-canvas"></canvas>
    </view>
    
    <!-- ç™½è‰²åœ†åœˆ -->
    <view class="timer-circle">
      <view class="timer-content">
        <view class="tomato-counter">
          <text class="tomato-icon">â±</text>
          <text class="tomato-count">0/1</text>
        </view>
        <view class="time-display">{{timeUtil.formatTime(timeLeft)}}</view>
      </view>
    </view>
  </view>
  
  <!-- æ§åˆ¶æŒ‰é’® -->
  <view class="control-area">
    <button class="btn stop-btn" bindtap="onStop">
      <text>åœæ­¢</text>
    </button>
    
    <button class="btn pause-btn" bindtap="onPause">
      <text class="pause-icon">{{paused ? '' : ''}}</text>
      <text>{{paused ? 'æš‚åœ' : 'æš‚åœ'}}</text>
    </button>
  </view>
  
  <!-- å®ŒæˆæŒ‰é’® -->
  <button class="finish-btn" bindtap="onFinish">
    <text class="check-icon">âœ“</text>
    <text>ç«‹å³å®Œæˆ</text>
  </button>
  
  <!-- åº•éƒ¨é€‰é¡¹åŒºåŸŸ -->
  <view class="bottom-options">
    <view class="option">
      <view class="option-icon">âŒ›</view>
      <text class="option-text">å®šæ—¶å™¨æ¨¡å¼</text>
    </view>
    <view class="option">
      <view class="option-icon">ğŸ”ˆ</view>
      <text class="option-text">ç™½å™ªå£°</text>
    </view>
  </view>
</view> 